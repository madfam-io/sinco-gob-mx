<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="appTitle">SINCO 2019 - Sistema Nacional de Clasificación de Ocupaciones</title>
    <!-- CSP is set via headers (vercel.json). Meta CSP kept minimal for local file:// dev if needed. -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; img-src 'self' data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com; script-src 'self'; connect-src 'self'; object-src 'none'; base-uri 'self'"
    />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="/src/style.css" />
    --bg-primary: #0f0f1f; --bg-secondary: #1a1a2e; --bg-tertiary: #16213e; --bg-interactive:
    rgba(22, 33, 62, 0.5); --text-primary: #e0e0e0; --text-secondary: #999; --accent-primary:
    #00d4ff; --accent-secondary: #0099ff; --accent-gradient: linear-gradient(135deg,
    var(--accent-primary), var(--accent-secondary)); --shadow-color-light: rgba(0, 212, 255, 0.3);
    --shadow-color-dark: rgba(0, 0, 0, 0.5); --border-color: rgba(255, 255, 255, 0.1);
    --font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu,
    Cantarell, sans-serif; --success-gradient: linear-gradient(135deg, #00ff88, #00cc66);
    --warning-gradient: linear-gradient(135deg, #ffaa00, #ff8800); --danger-gradient:
    linear-gradient(135deg, #ff4466, #ff2244); } *, *::before, *::after { margin: 0; padding: 0;
    box-sizing: border-box; } body { font-family: var(--font-family); background: var(--bg-primary);
    color: var(--text-primary); line-height: 1.6; overflow: hidden; } .hidden { display: none
    !important; } .header { background: linear-gradient(135deg, var(--bg-secondary) 0%,
    var(--bg-tertiary) 100%); padding: 1rem; box-shadow: 0 4px 20px var(--shadow-color-dark);
    position: sticky; top: 0; z-index: 1000; } .header h1 { font-size: 1.5rem; background:
    var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    background-clip: text; text-fill-color: transparent; margin-bottom: 1rem; animation: glow 2s
    ease-in-out infinite alternate; text-align: center; } @keyframes glow { from { filter:
    drop-shadow(0 0 15px var(--shadow-color-light)); } to { filter: drop-shadow(0 0 25px rgba(0,
    153, 255, 0.8)); } } .stats-bar { display: grid; grid-template-columns: repeat(2, 1fr); gap:
    0.5rem; } .stat-item { background: rgba(255, 255, 255, 0.05); padding: 0.5rem; border-radius:
    10px; border: 1px solid var(--border-color); transition: all 0.3s ease; text-align: center; }
    .stat-item:hover { background: rgba(255, 255, 255, 0.1); transform: translateY(-2px);
    box-shadow: 0 4px 20px var(--shadow-color-light); } .stat-label { font-size: 0.75rem; opacity:
    0.8; } .stat-value { font-size: 1.1rem; font-weight: bold; color: var(--accent-primary); }
    .controls { display: flex; flex-direction: column; gap: 1rem; padding: 1rem; background:
    var(--bg-interactive); } .search-box { width: 100%; position: relative; } .search-box input {
    width: 100%; padding: 0.8rem 1rem 0.8rem 3rem; background: rgba(255, 255, 255, 0.05); border:
    2px solid var(--border-color); border-radius: 25px; color: white; font-size: 1rem; transition:
    all 0.3s ease; } .search-box input:focus { outline: none; border-color: var(--accent-primary);
    background: rgba(255, 255, 255, 0.1); box-shadow: 0 0 20px var(--shadow-color-light); }
    .search-icon { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color:
    var(--accent-primary); pointer-events: none; } .controls-row { display: flex; gap: 0.5rem;
    justify-content: space-between; align-items: center; } .view-toggle { display: flex; gap:
    0.25rem; background: rgba(255, 255, 255, 0.05); padding: 0.25rem; border-radius: 20px; }
    .view-btn { padding: 0.75rem 1rem; background: transparent; border: none; color:
    var(--text-secondary); cursor: pointer; border-radius: 15px; transition: all 0.3s ease;
    font-size: 0.95rem; white-space: nowrap; min-height: 44px; min-width: 44px; } .view-btn.active {
    background: var(--accent-gradient); color: white; box-shadow: 0 4px 15px
    var(--shadow-color-light); } .content { height: calc(100vh - 210px); position: relative; }
    .tree-view, .table-view, .cards-view { height: 100%; overflow: auto; padding: 1rem; } .node {
    cursor: pointer; } .node circle { fill: var(--bg-tertiary); stroke: var(--accent-primary);
    stroke-width: 2px; transition: all 0.3s ease; } .node:hover circle, .node.highlight circle {
    fill: var(--accent-primary); stroke-width: 4px; filter: drop-shadow(0 0 10px
    var(--accent-primary)); } .node.search-highlight circle { stroke: #ff0066; fill: #ff0066;
    filter: drop-shadow(0 0 15px #ff0066); } .node text { font-size: 12px; fill:
    var(--text-primary); text-shadow: 0 1px 3px var(--shadow-color-dark); pointer-events: none; }
    .link { fill: none; stroke: rgba(0, 212, 255, 0.3); stroke-width: 1.5px; } .link.highlight {
    stroke: var(--accent-primary); stroke-width: 2.5px; } .table-container { background: rgba(22,
    33, 62, 0.3); border-radius: 15px; overflow: auto; max-height: 100%; } table { width: 100%;
    border-collapse: collapse; } th { background: linear-gradient(135deg, rgba(0, 212, 255, 0.2),
    rgba(0, 153, 255, 0.2)); padding: 1rem; text-align: left; font-weight: 600; position: sticky;
    top: 0; z-index: 10; } td { padding: 0.8rem 1rem; border-bottom: 1px solid var(--border-color);
    } tr { transition: background-color 0.2s ease; } tr:hover { background: rgba(0, 212, 255, 0.05);
    } .salary-badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 15px;
    font-size: 0.85rem; font-weight: 600; color: var(--bg-primary); } .salary-high { background:
    var(--success-gradient); } .salary-medium { background: var(--warning-gradient); } .salary-low {
    background: var(--danger-gradient); color: white; } .cards-view { display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; } @media (max-width:
    480px) { .stats-bar { grid-template-columns: 1fr; } .controls { padding: 0.75rem; } .content {
    height: calc(100vh - 220px); } .division-card { padding: 1rem; } } .division-card { background:
    linear-gradient(135deg, var(--bg-interactive), rgba(16, 33, 62, 0.3)); border: 2px solid
    var(--border-color); border-radius: 15px; padding: 1.5rem; transition: all 0.3s ease; cursor:
    pointer; } .division-card:hover { transform: translateY(-5px); border-color:
    var(--accent-primary); box-shadow: 0 4px 30px var(--shadow-color-light); } .division-header {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; gap:
    1rem; } .division-title { font-size: 1.1rem; font-weight: bold; color: var(--accent-primary); }
    .occupation-count { background: rgba(0, 212, 255, 0.2); padding: 0.25rem 0.75rem; border-radius:
    15px; font-size: 0.85rem; white-space: nowrap; } .tooltip { position: fixed; padding: 1rem;
    background: rgba(10, 10, 10, 0.95); border: 2px solid rgba(0, 212, 255, 0.5); border-radius:
    10px; pointer-events: none; opacity: 0; transition: opacity 0.3s ease; z-index: 1001;
    backdrop-filter: blur(10px); box-shadow: 0 4px 20px var(--shadow-color-light); max-width: 300px;
    } .tooltip h3 { color: var(--accent-primary); margin-bottom: 0.5rem; font-size: 1.1rem; }
    .tooltip p { margin: 0.25rem 0; font-size: 0.9rem; } .tooltip strong { color:
    var(--text-primary); } .loader { position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center;
    z-index: 9999; transition: opacity 0.3s ease; } .loader-circle { width: 80px; height: 80px;
    border: 4px solid rgba(0, 212, 255, 0.2); border-top-color: var(--accent-primary);
    border-radius: 50%; animation: spin 1s linear infinite; } @keyframes spin { to { transform:
    rotate(360deg); } } @media (min-width: 768px) { .header { padding: 1.5rem 2rem; } .header h1 {
    font-size: 2.5rem; text-align: left; } .stats-bar { display: flex; gap: 2rem;
    grid-template-columns: none; } .stat-item { padding: 0.5rem 1rem; text-align: left; }
    .stat-label { font-size: 0.875rem; } .stat-value { font-size: 1.5rem; } .controls {
    flex-direction: row; padding: 1rem 2rem; gap: 1rem; flex-wrap: wrap; align-items: center; }
    .search-box { flex: 1; min-width: 300px; } .controls-row { gap: 1rem; } .view-btn { padding:
    0.5rem 1rem; font-size: 1rem; } .content { height: calc(100vh - 240px); } }
  </head>
  <body>
    <div class="header" role="banner">
      <h1 id="pageHeading">SINCO 2019 - Sistema Nacional de Clasificación de Ocupaciones</h1>
      <div class="controls-row" style="justify-content: flex-end; margin-bottom: 0.5rem">
        <button
          id="btn-toggle-stats"
          class="view-btn"
          aria-expanded="true"
          aria-controls="statsBar"
        >
          Ocultar métricas
        </button>
      </div>
      <div class="stats-bar" id="statsBar">
        <div class="stat-item">
          <div class="stat-label">Total Ocupaciones</div>
          <div id="stat-total-occupations" class="stat-value">...</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Divisiones</div>
          <div id="stat-divisions" class="stat-value">...</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Total Empleados</div>
          <div id="stat-total-employees" class="stat-value">...</div>
        </div>
        <div class="stat-item">
          <div class="stat-label">Salario Promedio</div>
          <div id="stat-avg-salary" class="stat-value">...</div>
        </div>
      </div>
    </div>

    <div class="controls">
      <div class="search-box" role="search">
        <span class="search-icon" aria-hidden="true">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </span>
        <input
          type="text"
          id="searchInput"
          placeholder="Buscar ocupación, código o salario..."
          aria-label="Buscar ocupación, código o salario"
        />
      </div>

      <div class="controls-row">
        <div class="view-toggle" aria-label="Cambiar vista" role="tablist">
          <button
            id="btn-tree"
            class="view-btn active"
            data-view="tree"
            role="tab"
            aria-selected="true"
            aria-controls="treeView"
          >
            Árbol
          </button>
          <button
            id="btn-table"
            class="view-btn"
            data-view="table"
            role="tab"
            aria-selected="false"
            aria-controls="tableView"
          >
            Tabla
          </button>
          <button
            id="btn-cards"
            class="view-btn"
            data-view="cards"
            role="tab"
            aria-selected="false"
            aria-controls="cardsView"
          >
            Tarjetas
          </button>
        </div>
        <div class="controls-row" aria-label="Acciones de árbol">
          <button id="btn-expand-all" class="view-btn">Expandir todo</button>
          <button id="btn-collapse-all" class="view-btn">Colapsar todo</button>
        </div>
      </div>
      <div
        class="controls-row"
        id="filtersBar"
        style="margin-top: 0.5rem; gap: 0.5rem; flex-wrap: wrap"
      >
        <label class="stat-label" for="filterFamily">Familia</label>
        <select id="filterFamily" aria-label="Filtrar por familia"></select>
        <label class="stat-label" for="filterLevel">Nivel</label>
        <select id="filterLevel" aria-label="Filtrar por nivel"></select>
        <label class="stat-label" for="filterLocation">Ubicación</label>
        <select id="filterLocation" aria-label="Filtrar por ubicación"></select>
        <label class="stat-label" for="filterOpenRoles">Vacantes</label>
        <select id="filterOpenRoles" aria-label="Filtrar por vacantes">
          <option value="">Todos</option>
          <option value="open">Solo abiertos</option>
          <option value="filled">Sin vacantes</option>
        </select>
        <div style="flex: 1"></div>
        <label for="langSelect" class="stat-label" style="margin-right: 0.5rem">Idioma</label>
        <select id="langSelect" aria-label="Seleccionar idioma">
          <option value="es">ES</option>
          <option value="en">EN</option>
        </select>
      </div>
    </div>

    <div class="content" role="main" aria-labelledby="pageHeading">
      <div id="treeView" class="tree-view" role="tabpanel" aria-labelledby="btn-tree">
        <div class="controls-row" style="justify-content: flex-end; margin-bottom: 0.5rem">
          <button id="btn-reset-zoom" class="view-btn">Restablecer zoom</button>
        </div>
        <svg id="treeSvg" role="img" aria-label="Árbol de ocupaciones"></svg>
      </div>
      <div id="tableView" class="table-view hidden" role="tabpanel" aria-labelledby="btn-table">
        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Código</th>
                <th>Ocupación</th>
                <th>División</th>
                <th>Salario Promedio</th>
                <th>Formalidad</th>
                <th>Empleados</th>
              </tr>
            </thead>
            <tbody id="tableBody"></tbody>
          </table>
        </div>
        <div class="controls-row" style="margin-top: 0.5rem; justify-content: center">
          <button id="tablePrev" class="view-btn">Anterior</button>
          <span
            id="tablePage"
            class="stat-label"
            style="min-width: 80px; text-align: center"
          ></span>
          <button id="tableNext" class="view-btn">Siguiente</button>
        </div>
      </div>
      <div
        id="cardsView"
        class="cards-view hidden"
        role="tabpanel"
        aria-labelledby="btn-cards"
      ></div>
      <div
        class="controls-row hidden"
        id="cardsPager"
        style="margin: 0.5rem 1rem; justify-content: center"
      >
        <button id="cardsPrev" class="view-btn">Anterior</button>
        <span id="cardsPage" class="stat-label" style="min-width: 80px; text-align: center"></span>
        <button id="cardsNext" class="view-btn">Siguiente</button>
      </div>
    </div>

    <div class="tooltip" id="tooltip" role="dialog" aria-live="polite" aria-hidden="true"></div>
    <div class="loader" id="loader">
      <div class="loader-circle"></div>
    </div>

    <script type="module" src="/src/main.js"></script>
    <script type="module" src="/src/i18n/i18n.js"></script>
  </body>
</html>
